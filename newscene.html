<!DOCTYPE html>
<html>

<head>
    <title>New Scene</title>
    <script type="text/javascript" src="assets/js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="assets/js/scenehandler.js"></script>
    <style>
        body {
            font-family: monospace;
            font-size: 1.2em;
            text-align: center;
        }
        div {
            margin: 1em;
        }
        input {
            width: 10em;
            color: black;
            font-size: 1em;
            border-style: solid;
            border-width: 0 0 1px 0;
            border-color: black;
        }
        input.button {
            background: lightgray;
            border-style: solid;
            border-width: 1px;
            border-color: black;
            margin: 1.5em;
        }
        input:focus {
            outline: none;
            color: black;
        }
        input.option,
        input.searchable,
        input.link {
            display: inline-block;
        }
        textarea {
            font-size: 1em;
        }
    </style>
    <script type="text/javascript">
        function addOptionField() {
            $("#options").append('<span class="option"><input class="option" type="text" placeholder="Menu Option"><input class="link" type="text" placeholder="SceneLink"></span><br />');
        }

        function addSearchableField() {
            $("#searchables").append('<span class="searchable"><input class="searchable" type="text" placeholder="Searchable Item"><input class="link" type="text" placeholder="SceneLink"></span><br />');
        }

        function renderJSON() {
            var optionCount = 0;
            var options = [];
            $("#options span").each(function () {
                options.push({
                    "text": "" + $(this).find("input.option").val(),
                    "scene": "" + $(this).find("input.link").val().toLowerCase(),
                    "id": "" + optionCount
                });

                optionCount++;
            });

            // Now create the sceneObject
            var sceneObject = new Scene($("#name").val(), $("#image").val(), $("#description").val(), options);

            // Set scene id
            sceneObject.id = $("#id").val().toLowerCase();

            // Find searchables
            var searchables = {};
            $("#searchables span").each(function () {
                searchables["" + $(this).find("input.searchable").val().toLowerCase()] = "" + $(this).find("input.link").val().toLowerCase();
            });
            sceneObject.searchables = searchables;
            console.log(JSON.stringify(sceneObject));

            // Final rendering
            $("#renderedJSON").html('"' + sceneObject.id.toLowerCase() + '":' + JSON.stringify(sceneObject));
        }
    </script>
</head>

<body>
    <h2>New Scene JSON Exporter</h2>
    <form>
        <div id="details">
            *
            <input id="id" type="text" placeholder="id">
            <br />*
            <input id="name" type="text" placeholder="Name">
            <br />*
            <input id="image" type="text" placeholder="image URL">
            <br />*
            <textarea id="description" placeholder="Description"></textarea>
            <h4>* required</h4>
        </div>
        <!-- OPTIONS -->
        <div id="options">
            <h2>Options</h2>
            *
            <span class="option"><input class="option" type="text" placeholder="Menu Option">
            <input class="link" type="text" placeholder="SceneLink"></span>
            <br />
        </div>
        <input class="button" type="button" onclick="addOptionField()" value="Add option">

        <!-- SEARCHABLES -->
        <div id="searchables">
            <h2>Searchables</h2>
            <span class="searchable"><input class="searchable" type="text" placeholder="Searchable Item">
            <input class='link' type='text' placeholder='SceneLink'></span>
            <br />
        </div>
        <input class="button" type="button" onclick="addSearchableField()" value="Add searchable">
    </form>
    <h2>Render JSON</h2>
    <p>Fill out the desired forms, and then hit the Render JSON button</p>
    <input class="button" type="button" onclick="renderJSON()" value="Render JSON">
    <h3>Exported JSON</h3>
    <p>Copy and paste the JSON below into scenes.json. Don't forget the comma first, though.</p>
    <textarea id="renderedJSON"></textarea>
</body>

</html>